{"paper_id": "1c56023b04a6fa6cad58de4332fb7ce830e658c3", "metadata": {"title": "Deep Learning System to Screen Coronavirus Disease 2019 Pneumonia Correspondence to", "authors": [{"first": "Xiaowei", "middle": [], "last": "Xu", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}, {"first": ";", "middle": ["Xiangao"], "last": "Jiang", "suffix": "", "affiliation": {"laboratory": "", "institution": "Wenzhou central Hospital", "location": {"postCode": "325000", "settlement": "Wenzhou", "region": "Zhejiang", "country": "People's Republic of China"}}, "email": ""}, {"first": "Chunlian", "middle": [], "last": "Ma", "suffix": "", "affiliation": {"laboratory": "", "institution": "First People's Hospital of Wenling", "location": {"postCode": "317500", "settlement": "WenLing", "region": "Zhejiang", "country": "People's Republic of China"}}, "email": ""}, {"first": "Peng", "middle": [], "last": "Du", "suffix": "", "affiliation": {"laboratory": "Artificial Intelligence Lab", "institution": "Hangzhou AiSmart-Image-Cloud-Analysis Co., Ltd", "location": {"postCode": "310012", "settlement": "Hangzhou", "region": "Zhejiang", "country": "People's Republic of China"}}, "email": ""}, {"first": "Xukun", "middle": [], "last": "Li", "suffix": "", "affiliation": {"laboratory": "Artificial Intelligence Lab", "institution": "Hangzhou AiSmart-Image-Cloud-Analysis Co., Ltd", "location": {"postCode": "310012", "settlement": "Hangzhou", "region": "Zhejiang", "country": "People's Republic of China"}}, "email": ""}, {"first": "Shuangzhi", "middle": [], "last": "Lv", "suffix": "", "affiliation": {"laboratory": "", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "region": "Zhejiang", "country": "People's Republic of China"}}, "email": ""}, {"first": ";", "middle": [], "last": "Liang", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}, {"first": "Yu", "middle": [], "last": "", "suffix": "", "affiliation": {}, "email": ""}, {"first": ";", "middle": ["Yanfei"], "last": "Chen", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}, {"first": "Junwei", "middle": [], "last": "Su", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}, {"first": "Guanjing", "middle": [], "last": "Lang", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}, {"first": "Yongtao", "middle": [], "last": "Li", "suffix": "", "affiliation": {}, "email": ""}, {"first": "Hong", "middle": [], "last": "Zhao", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}, {"first": "Kaijin", "middle": [], "last": "Xu", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}, {"first": "Lingxiang", "middle": [], "last": "Ruan", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}, {"first": "Wei", "middle": [], "last": "Wu", "suffix": "", "affiliation": {"laboratory": "State Key Laboratory for Diagnosis", "institution": "Zhejiang University", "location": {"postCode": "310003", "settlement": "Hangzhou", "country": "China"}}, "email": ""}]}, "abstract": [{"text": "IMPORTANCE: We found that the real time reverse transcription-polymerase chain reaction (RT-PCR) detection of viral RNA from sputum or nasopharyngeal swab has a relatively low positive rate in the early stage to determine COVID-19 (named by the World Health Organization). The manifestations of computed tomography (CT) imaging of COVID-19 had their own characteristics, which are different from other types of viral pneumonia, such as Influenza-A viral pneumonia. Therefore, clinical doctors call for another early diagnostic criteria for this new type of pneumonia as soon as possible. OBJECTIVE: This study aimed to establish an early screening model to distinguish COVID-19 pneumonia from Influenza-A viral pneumonia and healthy cases with pulmonary CT images using deep learning techniques. DESIGN: The candidate infection regions were first segmented out using a 3-dimensional deep learning model from pulmonary CT image set. These separated images were then categorized into COVID-19, Influenza-A viral pneumonia and irrelevant to infection groups, together with the corresponding confidence scores using a location-attention classification model. Finally the infection type and total confidence score of this CT case were calculated with Noisy-or Bayesian function. SETTING: CT samples contributed from three COVID-19 designated hospitals from Zhejiang Province, China. PARTICIPANTS: A total of 618 CT samples were collected: 219 from 110 patients with COVID-19, 224 CT samples from 224 patients with Influenza-A viral 5 / 29 pneumonia, and 175 CT samples from healthy people.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}, {"text": "The experiments result of benchmark dataset showed that the overall accuracy was 86.7 % from the perspective of CT cases as a whole.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}, {"text": "The deep learning models established in this study were effective for the early screening of COVID-19 patients and demonstrated to be a promising supplementary diagnostic method for frontline clinical doctors.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}], "body_text": [{"text": "At the end of 2019, the novel coronavirus disease 2019 pneumonia occurred in the city of Wuhan, China. [1] [2] [3] [4] On January 24, 2020, Huang et al. 5 summarized the clinical characteristics of 41 patients with COVID-19, indicating that the common onset symptoms were fever, cough, myalgia, or fatigue. All these 41 patients had pneumonia and their chest CT examination showed abnormalities. The complications included acute respiratory distress syndrome, acute heart injury, and secondary infections. Thirteen (32%) patients were admitted to the intensive care unit (ICU), and six (15%) died. The the Kok-KH 6 team at the University of Hong Kong found the evidence of human-to-human transmission of COVID-19 for the first time.", "cite_spans": [{"start": 103, "end": 106, "text": "[1]", "ref_id": "BIBREF0"}, {"start": 107, "end": 110, "text": "[2]", "ref_id": "BIBREF2"}, {"start": 111, "end": 114, "text": "[3]", "ref_id": "BIBREF4"}, {"start": 115, "end": 118, "text": "[4]", "ref_id": "BIBREF6"}, {"start": 153, "end": 154, "text": "5", "ref_id": "BIBREF8"}], "ref_spans": [], "section": "Introduction"}, {"text": "COVID-19 causes severe respiratory symptoms and is associated with relatively high ICU admission and mortality. The current clinical experience for treating these patients revealed that the RT-PCR detection of viral RNA from sputum or nasopharyngeal swab had a low positive rate in the early stage. However, a high proportion of abnormal chest CT images were obtained from patients with this disease.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "The manifestations of CT imaging of COVID-19 cases had their own characteristics, different from the manifestations of CT imaging of other viral pneumonia such as Influenza-A viral pneumonia, as showed in Figure 1 . Therefore, clinical doctors called for replacing nucleic acid testing with lung CT as one of the early diagnostic criteria for this new type of pneumonia as soon as possible.", "cite_spans": [], "ref_spans": [{"start": 205, "end": 213, "text": "Figure 1", "ref_id": "FIGREF0"}], "section": "Introduction"}, {"text": "With the rapid development of computer technology, digital image processing technology has been widely applied in the medical field, including organ segmentation and image enhancement and repair, providing support for subsequent medical diagnosis. 7, 8 Deep learning technologies, such as convolutional neural network (CNN) with the strong ability of nonlinear modeling, have extensive applications in medical image processing as well. [9] [10] [11] [12] Relevant studies were conducted on the diagnosis of pulmonary nodules, 13-14 classification of benign and malignant tumors, 15 and pulmonary tuberculosis analysis and disease prediction [16] [17] [18] worldwide.", "cite_spans": [{"start": 248, "end": 250, "text": "7,", "ref_id": "BIBREF10"}, {"start": 251, "end": 252, "text": "8", "ref_id": "BIBREF11"}, {"start": 436, "end": 439, "text": "[9]", "ref_id": "BIBREF13"}, {"start": 440, "end": 444, "text": "[10]", "ref_id": "BIBREF14"}, {"start": 445, "end": 449, "text": "[11]", "ref_id": "BIBREF16"}, {"start": 450, "end": 454, "text": "[12]", "ref_id": "BIBREF18"}, {"start": 579, "end": 581, "text": "15", "ref_id": "BIBREF21"}, {"start": 641, "end": 645, "text": "[16]", "ref_id": "BIBREF23"}, {"start": 646, "end": 650, "text": "[17]", "ref_id": "BIBREF24"}, {"start": 651, "end": 655, "text": "[18]", "ref_id": "BIBREF25"}], "ref_spans": [], "section": "Introduction"}, {"text": "In this study, multiple CNN models were used to classify CT image datasets and calculate the infection probability of COVID-19. The findings might greatly assist in the early screening of patients with COVID-19. Influenza-A viral pneumonia, and 30 healthy case. Furthermore, the test cases of CT set were selected from the people who had not been included in the training stage. Figure 2 shows the whole process of COVID-19 diagnostic report generation in this study. First, the CT images were preprocessed to extract effective pulmonary regions. Figure 2 . Process flow chart.", "cite_spans": [], "ref_spans": [{"start": 379, "end": 387, "text": "Figure 2", "ref_id": null}, {"start": 547, "end": 555, "text": "Figure 2", "ref_id": null}], "section": "Introduction"}, {"text": "To study was expedited using the same method and models in data preprocessing and candidate region segmentation stages as a previous study on pulmonary tuberculosis. 17 The focus of infections from pulmonary tuberculosis had multiple structures and types, including miliary, infiltrative, caseous, tuberculoma, and cavitary etc. Although, the VNET 20 based segmentation model VNET-IR-RPN 17 was trained for pulmonary tuberculosis purpose, it was verified to be still good enough to separate candidate patches from viral pneumonia.", "cite_spans": [{"start": 166, "end": 168, "text": "17", "ref_id": "BIBREF24"}], "ref_spans": [], "section": "Dataset preprocessing and candidate region segmentation"}, {"text": "Moreover, in the study of pulmonary tuberculosis, the VNET-IR-RPN model was used both for both segmentation and classification. Only the segmentation-related bounding box regression part was preserved, regardless of the classification results, because only the former task was required at this stage in this study.", "cite_spans": [], "ref_spans": [], "section": "Dataset preprocessing and candidate region segmentation"}, {"text": "A large number of non-infection regions irrelevant to this study were also separated using the 3D segmentation model, including fibrotic structure of pulmonary, calcification spots, or healthy regions identified incorrectly. Therefore, an extra category was added as irrelevant-to-infection besides COVID-19 and ", "cite_spans": [], "ref_spans": [], "section": "Image data processing and augmentation"}, {"text": "The work of Jeffrey Kanne 21 and Chung M et al, 22 showed at least three distinguishing features of COVID-19: ground-glass appearance, striking peripheral distribution along with the pleura, and usually more than one independent focus of infections for one case, as showed in Figure 3 .", "cite_spans": [{"start": 48, "end": 50, "text": "22", "ref_id": "BIBREF29"}], "ref_spans": [{"start": 276, "end": 284, "text": "Figure 3", "ref_id": "FIGREF1"}], "section": "Location-attention classification"}, {"text": "The models were optimized based on these findings. The image classification model was designed to distinguish the appearance and structure of different infections.", "cite_spans": [], "ref_spans": [], "section": "Location-attention classification"}, {"text": "Moreover, relative distance-from-edge as an extra weights, was used for the model to learn the relative location information of the patch on the pulmonary image. The focus of infections located close to the pleura were be more likely to be recognized as COVID-19.", "cite_spans": [], "ref_spans": [], "section": "Location-attention classification"}, {"text": "The relative distance-from-edge of each patch was calculated as followings:", "cite_spans": [], "ref_spans": [], "section": "Location-attention classification"}, {"text": "13 / 29 1) Measure the minimum distance from the mask to the center of this patch (double-headed arrow as showed in Fig 3c) 2) Obtain the diagonal of the minimum circumscribed rectangle of the pulmonary image (Fig 3d) 3) Then the relative distance-from-edge achieved by the distance obtained from step 1) divided by the diagonal from step 2). ", "cite_spans": [], "ref_spans": [{"start": 116, "end": 123, "text": "Fig 3c)", "ref_id": "FIGREF1"}, {"start": 209, "end": 217, "text": "(Fig 3d)", "ref_id": "FIGREF1"}], "section": "Location-attention classification"}, {"text": "Two CNN three-dimensional classification models were evaluated in this study, as showed in Figure 4 . One was a relative traditional ResNet 23 -based network and another model was designed based on the first network structure by concatenating the location-attention mechanism in the full-connection layer to improve the overall accuracy rate.", "cite_spans": [], "ref_spans": [{"start": 91, "end": 99, "text": "Figure 4", "ref_id": "FIGREF2"}], "section": "Network structure"}, {"text": "The classical ResNet-18 network structure was used for image feature extraction. Pooling operations were also used for the dimensional reduction of data to prevent overfitting and improve the problem of generalization.", "cite_spans": [], "ref_spans": [], "section": "Network structure"}, {"text": "The output of the convolution layer was flattened to a 256-dimensional feature vector and then converted into a 16-dimensional feature vector using a full-connection network. For the location-attention network, the value of relative distance-from-edge was first normalized to the same order of magnitude and then concatenated to this full-connection network structure. Next, three full-connection layers were followed to output the final classification result together with the confidence score. ", "cite_spans": [], "ref_spans": [], "section": "Network structure"}, {"text": "Inspired by the theory of Bagging prediction algorithm 24 in machine learning technology, one candidate region was represented by three image patches: the center image together with its two neighbors. These three images voted for this whole region with the following strategies:", "cite_spans": [], "ref_spans": [], "section": "Vote for each candidate region"}, {"text": "1) If at least two images were categorized into the same type, then the image with the maximum confidence score in this type was selected 2) Otherwise, the image with the maximum confidence score was picked (no type dominated).", "cite_spans": [], "ref_spans": [], "section": "Vote for each candidate region"}, {"text": "Regions that voted as irrelevant-to-infection type was ignored in the next step.", "cite_spans": [], "ref_spans": [], "section": "Vote for each candidate region"}, {"text": "One of the remarkable features of COVID-19 is more than one independent focus of infections in one CT case. It is reasonable that the overall probability is much larger than 50% if a patient has two COVID-19 regions, both having a 50% probability.", "cite_spans": [], "ref_spans": [], "section": "Noisy-or Bayesian function to deduce the overall report"}, {"text": "Accordingly, the total infection confidence score (P) for one infection type was calculated using the probability formula of the Noisy-or Bayesian function as follows:", "cite_spans": [], "ref_spans": [], "section": "Noisy-or Bayesian function to deduce the overall report"}, {"text": "where i P represents the confidence of the ith region.", "cite_spans": [], "ref_spans": [], "section": "Noisy-or Bayesian function to deduce the overall report"}, {"text": "The confidence scores of two types 19 ", "cite_spans": [{"start": 35, "end": 37, "text": "19", "ref_id": "BIBREF26"}], "ref_spans": [], "section": "/ 29"}, {"text": "An Intel i7-8700k CPU together with NVIDIA GPU GeForce GTX 1080ti was used as the testing server. The processing time largely depended on the number of image layers in one CT set. On average, it was less than 30s for a CT set with 70 layers from data-preprocessing to the output of the report.", "cite_spans": [], "ref_spans": [], "section": "Evaluation platform"}, {"text": "As one of the most classical loss function used in classification models, cross-entropy was used in this study. When the epoch number of training iterations increased to more than 1000, the loss value did not decrease or increase obviously, suggesting that the models converged well to a relative optimal state without distinct overfitting. The training curves of the loss value and the accuracy for two classification models were showed in Figure 5 . The network with the location-attention mechanism achieved better performance on the training dataset compared with the original ResNet. ", "cite_spans": [], "ref_spans": [{"start": 441, "end": 449, "text": "Figure 5", "ref_id": "FIGREF3"}], "section": "Training process"}, {"text": "A total of 30 CT samples were selected randomly from each group (COVID-19,", "cite_spans": [], "ref_spans": [], "section": "Segmentation"}, {"text": "Influenza-A-viral-pneumonia and healthy) for the test set, following the rule that this person (owner of this CT) had not been included in the previous training stage.", "cite_spans": [], "ref_spans": [], "section": "Segmentation"}, {"text": "Moreover, the segmentation model VNET-IR-RPN was configured to reduce the proposal's threshold to maximum separate candidate regions even through many normal regions could be included in. One CT case from COVID-19 group that had no region segmented as COVID-19 or Influenza-A-viral-pneumonia and hence wrongly categorized into the no-infection-found group, as showed in Figure 6 . These focus of infections could be barely notified by human eyed and seemed too tenuous to be captured by the segmentation model for this study.", "cite_spans": [], "ref_spans": [{"start": 370, "end": 378, "text": "Figure 6", "ref_id": null}], "section": "Segmentation"}, {"text": "(a) (b) (c) Figure 6 . All CT images from a single CT case. The focus of infections are pointed out by arrows.", "cite_spans": [], "ref_spans": [{"start": 12, "end": 20, "text": "Figure 6", "ref_id": null}], "section": "Segmentation"}, {"text": "A total of 1,710 image patches were acquired from 90 CT samples, including 357 COVID-19, 390 Influenza-A-viral-pneumonia, and 963 irrelevant-to-infection (ground truth). To determine which was the optimal approach, the design of each methodology was assessed using a confusion matrix. Two network structures were evaluated: with and without the location-attention mechanism, as showed in Table 1 and Table 2 . The average f1_scores for two models were 0.750 and 0.764, which indicated that the second model with location-attention mechanism achieved better performance averagely. Therefore, this model was used for the rest of this study.", "cite_spans": [], "ref_spans": [{"start": 388, "end": 395, "text": "Table 1", "ref_id": "TABREF6"}, {"start": 400, "end": 407, "text": "Table 2", "ref_id": null}], "section": "Classification for a single image patch"}, {"text": "Each image patch voted to represent this entire candidate region. A total of 570 candidate cubes were distinguished, including 119 COVID-19, 130", "cite_spans": [], "ref_spans": [], "section": "Vote for a region"}, {"text": "Influenza-A-viral-pneumonia and 321 irrelevant-to-infection regions (ground truth).", "cite_spans": [], "ref_spans": [], "section": "Vote for a region"}, {"text": "The confusion matrix of voting result and corresponding recall, precision and f1-score were showed in Table 3 and ", "cite_spans": [], "ref_spans": [{"start": 102, "end": 109, "text": "Table 3", "ref_id": null}], "section": "Vote for a region"}, {"text": "Noisy-or Bayesian function was used to identify the dominated infection types. Three types result exported in the final report: COVID-19, Influenza-A-viral-pneumonia and no-infection-found. The experimental results are summarize in Table 5 and Table 6 .", "cite_spans": [], "ref_spans": [{"start": 232, "end": 251, "text": "Table 5 and Table 6", "ref_id": null}], "section": "Result of the classification for the CT samples as a whole"}, {"text": "As the irrelevant-to-infection items (previous step) would be ignored and not be counted by the Bayesian function, we only compare the average f1-score for the first two items. They were 0.806 and 0.843 respectively, which showed a promotion of Moreover, efforts should be made to improve the segmentation and classification model. A better exclusive models should be designed for training, the segmentation and classification accuracy of the model should be improved, and the generalization performance of this algorithm should be verified with a larger data set.", "cite_spans": [], "ref_spans": [], "section": "Result of the classification for the CT samples as a whole"}, {"text": "In this multi-center case study, we had presented a novel method that could screen COVID-19 fully automatically by deep learning technologies. Models with location-attention mechanism could more accurately classify COVID-19 at chest radiography with the overall accuracy rate of 86.7 % and could be a promising supplementary diagnostic method for frontline clinical doctors.", "cite_spans": [], "ref_spans": [], "section": "Conclusion"}], "bib_entries": {"BIBREF0": {"ref_id": "b0", "title": "A Novel Coronavirus from Patients with Pneumonia in China", "authors": [{"first": "N", "middle": [], "last": "Zhu", "suffix": ""}, {"first": "D", "middle": [], "last": "Zhang", "suffix": ""}, {"first": "W", "middle": [], "last": "Wang", "suffix": ""}], "year": 2019, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF2": {"ref_id": "b2", "title": "Early Transmission Dynamics in Wuhan, China, of Novel Coronavirus-Infected Pneumonia", "authors": [{"first": "Q", "middle": [], "last": "Li", "suffix": ""}, {"first": "X", "middle": [], "last": "Guan", "suffix": ""}, {"first": "P", "middle": [], "last": "Wu", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF4": {"ref_id": "b4", "title": "New SARS-like virus in China triggers alarm", "authors": [{"first": "J", "middle": [], "last": "Cohen", "suffix": ""}, {"first": "D", "middle": [], "last": "Normile", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF6": {"ref_id": "b6", "title": "Detection of 2019 novel coronavirus (2019-nCoV) by real-time RT-PCR", "authors": [{"first": "V", "middle": ["M"], "last": "Corman", "suffix": ""}, {"first": "O", "middle": [], "last": "Landt", "suffix": ""}, {"first": "M", "middle": [], "last": "Kaiser", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF8": {"ref_id": "b8", "title": "Clinical features of patients infected with 2019 novel coronavirus in Wuhan", "authors": [{"first": "C", "middle": [], "last": "Huang", "suffix": ""}, {"first": "Y", "middle": [], "last": "Wang", "suffix": ""}, {"first": "X", "middle": [], "last": "Li", "suffix": ""}], "year": 2020, "venue": "China[J]. Lancet", "volume": "", "issn": "20", "pages": "30183--30188", "other_ids": {"DOI": ["10.1016/S0140-6736(20)30183-5"]}}, "BIBREF9": {"ref_id": "b9", "title": "A familial cluster of pneumonia associated with the 2019 novel coronavirus indicating person-to-person transmission: a study of a family cluster", "authors": [{"first": "J", "middle": ["F"], "last": "Chan", "suffix": ""}, {"first": "S", "middle": [], "last": "Yuan", "suffix": ""}, {"first": "K", "middle": ["H"], "last": "Kok", "suffix": ""}], "year": 2020, "venue": "J]. Lancet", "volume": "", "issn": "20", "pages": "30154--30163", "other_ids": {"DOI": ["10.1016/S0140-6736(20"]}}, "BIBREF10": {"ref_id": "b10", "title": "Automatic Organ Segmentation for CT Scans Based on Super-Pixel and Convolutional Neural Networks", "authors": [{"first": "X", "middle": [], "last": "Liu", "suffix": ""}, {"first": "S", "middle": [], "last": "Guo", "suffix": ""}, {"first": "B", "middle": [], "last": "Yang", "suffix": ""}], "year": 2018, "venue": "Journal of Digital Imaging", "volume": "", "issn": "6", "pages": "", "other_ids": {}}, "BIBREF11": {"ref_id": "b11", "title": "Deep Bilateral Learning for Real-Time Image Enhancement", "authors": [{"first": "Micha\u00eb", "middle": ["L"], "last": "Gharbi", "suffix": ""}, {"first": "J", "middle": [], "last": "Chen", "suffix": ""}, {"first": "J T", "middle": [], "last": "Barron", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF13": {"ref_id": "b13", "title": "Deep Learning Techniques for Medical Image Segmentation: Achievements and Challenges", "authors": [{"first": "M H", "middle": [], "last": "Hesamian", "suffix": ""}, {"first": "W", "middle": [], "last": "Jia", "suffix": ""}, {"first": "X", "middle": [], "last": "He", "suffix": ""}], "year": 2019, "venue": "Journal of Digital Imaging", "volume": "", "issn": "8", "pages": "", "other_ids": {}}, "BIBREF14": {"ref_id": "b14", "title": "Correction to: Deep learning reconstruction improves image quality of abdominal ultra-high-resolution CT", "authors": [{"first": "M", "middle": [], "last": "Akagi", "suffix": ""}, {"first": "Y", "middle": [], "last": "Nakamura", "suffix": ""}, {"first": "T", "middle": [], "last": "Higaki", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF16": {"ref_id": "b16", "title": "Pulmonary Artery-Vein Classification in CT Images Using Deep Learning", "authors": [{"first": "P", "middle": [], "last": "Nardelli", "suffix": ""}, {"first": "D", "middle": [], "last": "Jimenez-Carretero", "suffix": ""}, {"first": "D", "middle": [], "last": "Bermejo-Pelaez", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF18": {"ref_id": "b18", "title": "AnatomyNet: Deep learning for fast and fully automated whole-volume segmentation of head and neck anatomy", "authors": [{"first": "W", "middle": [], "last": "Zhu", "suffix": ""}, {"first": "Y", "middle": [], "last": "Huang", "suffix": ""}, {"first": "L", "middle": [], "last": "Zeng", "suffix": ""}], "year": 2019, "venue": "J]. Medical Physics", "volume": "46", "issn": "2", "pages": "", "other_ids": {}}, "BIBREF19": {"ref_id": "b19", "title": "Added Value of Computer-aided CT Image Features for Early Lung Cancer Diagnosis with Small Pulmonary Nodules: A Matched Case-Control Study. Radiology", "authors": [{"first": "P", "middle": [], "last": "Huang", "suffix": ""}, {"first": "S", "middle": [], "last": "Park", "suffix": ""}, {"first": "R", "middle": [], "last": "Yan", "suffix": ""}], "year": 2018, "venue": "", "volume": "286", "issn": "", "pages": "286--295", "other_ids": {"DOI": ["10.1148/radiol.2017162725"]}}, "BIBREF20": {"ref_id": "b20", "title": "End-to-end lung cancer screening with three-dimensional deep learning on low-dose chest computed tomography", "authors": [{"first": "D", "middle": [], "last": "Ardila", "suffix": ""}, {"first": "A", "middle": ["P"], "last": "Kiraly", "suffix": ""}, {"first": "S", "middle": [], "last": "Bharadwaj", "suffix": ""}], "year": 2019, "venue": "Nat Med", "volume": "25", "issn": "6", "pages": "954--961", "other_ids": {"DOI": ["10.1038/s41591-019-0447-x"]}}, "BIBREF21": {"ref_id": "b21", "title": "Dermatologist-level classification of skin", "authors": [{"first": "A", "middle": [], "last": "Esteva", "suffix": ""}, {"first": "B", "middle": [], "last": "Kuprel", "suffix": ""}, {"first": "R", "middle": ["A"], "last": "Novoa", "suffix": ""}], "year": null, "venue": "", "volume": "27", "issn": "", "pages": "", "other_ids": {}}, "BIBREF23": {"ref_id": "b23", "title": "Deep Learning at Chest Radiography: Automated Classification of, Pulmonary Tuberculosis by Using Convolutional Neural Networks", "authors": [{"first": "P", "middle": [], "last": "Lakhani", "suffix": ""}, {"first": "B", "middle": [], "last": "Sundaram", "suffix": ""}], "year": 2017, "venue": "Radiology", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF24": {"ref_id": "b24", "title": "Deep Learning System That Generates Quantitative CT Reports for Diagnosing Pulmonary Tuberculosis", "authors": [{"first": "W", "middle": [], "last": "Wu", "suffix": ""}, {"first": "X", "middle": [], "last": "Li", "suffix": ""}, {"first": "P", "middle": [], "last": "Du", "suffix": ""}], "year": 2019, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"arXiv": ["arXiv:1910.02285"]}}, "BIBREF25": {"ref_id": "b25", "title": "AE-CNN Classification of Pulmonary Tuberculosis Based on CT", "authors": [{"first": "L", "middle": [], "last": "Li", "suffix": ""}, {"first": "H", "middle": [], "last": "Huang", "suffix": ""}, {"first": "Jin", "middle": ["X"], "last": "", "suffix": ""}], "year": 2018, "venue": "9th International Conference on Information Technology in Medicine and Education (ITME)", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF26": {"ref_id": "b26", "title": "Learning Bayesian network parameters from small data sets: application of Noisy-OR gates", "authors": [{"first": "A", "middle": [], "last": "Onisko", "suffix": ""}, {"first": "M", "middle": [], "last": "Druzdzel", "suffix": ""}, {"first": "H", "middle": [], "last": "Wasyluk", "suffix": ""}], "year": 2001, "venue": "International Journal of Approximate Reasoning", "volume": "27", "issn": "2", "pages": "165--182", "other_ids": {}}, "BIBREF27": {"ref_id": "b27", "title": "Fully Convolutional Neural Networks for Volumetric Medical Image Segmentation", "authors": [{"first": "F", "middle": [], "last": "Milletari", "suffix": ""}, {"first": "N", "middle": [], "last": "Navab", "suffix": ""}, {"first": "S A. V-Net", "middle": [], "last": "Ahmadi", "suffix": ""}], "year": 2016, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"arXiv": ["arXiv:1606.04797"]}}, "BIBREF28": {"ref_id": "b28", "title": "Chest CT Findings in 2019 Novel Coronavirus (2019-nCoV) Infections from Wuhan, China: Key Points for the Radiologist", "authors": [{"first": "", "middle": [], "last": "Jeffrey P Kanne", "suffix": ""}], "year": 2020, "venue": "Radiology", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF29": {"ref_id": "b29", "title": "CT Imaging Features of 2019 Novel Coronavirus (2019-nCoV", "authors": [{"first": "M", "middle": [], "last": "Chung", "suffix": ""}, {"first": "A", "middle": [], "last": "Bernheim", "suffix": ""}, {"first": "X", "middle": [], "last": "Mei", "suffix": ""}], "year": 2020, "venue": "Radiology", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF30": {"ref_id": "b30", "title": "Deep Residual Learning for Image Recognition", "authors": [{"first": "K", "middle": [], "last": "He", "suffix": ""}, {"first": "X", "middle": [], "last": "Zhang", "suffix": ""}, {"first": "S", "middle": [], "last": "Ren", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF31": {"ref_id": "b31", "title": "Bagging predictors", "authors": [{"first": "Leo", "middle": [], "last": "Breiman", "suffix": ""}], "year": null, "venue": "Machine Learning", "volume": "24", "issn": "", "pages": "123--140", "other_ids": {}}, "BIBREF32": {"ref_id": "b32", "title": "A novel coronavirus outbreak of global health concern", "authors": [{"first": "C", "middle": [], "last": "Wang", "suffix": ""}, {"first": "P", "middle": ["W"], "last": "Horby", "suffix": ""}, {"first": "F", "middle": ["G"], "last": "Hayden", "suffix": ""}], "year": 2020, "venue": "J]. Lancet", "volume": "", "issn": "20", "pages": "30185--30194", "other_ids": {"DOI": ["10.1016/S0140-6736(20"]}}, "BIBREF33": {"ref_id": "b33", "title": "First Case of 2019 Novel Coronavirus in the United States", "authors": [{"first": "M", "middle": ["L"], "last": "Holshue", "suffix": ""}, {"first": "C", "middle": [], "last": "Debolt", "suffix": ""}, {"first": "S", "middle": [], "last": "Lindquist", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF35": {"ref_id": "b35", "title": "Epidemiological and clinical characteristics of 99 cases of 2019 novel coronavirus pneumonia in Wuhan, China: a descriptive study", "authors": [{"first": "N", "middle": [], "last": "Chen", "suffix": ""}, {"first": "M", "middle": [], "last": "Zhou", "suffix": ""}, {"first": "X", "middle": [], "last": "Dong", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}}, "ref_entries": {"FIGREF0": {"text": "Typical transverse-section CT images: (a) COVID-19; (b) Influenza-A viral pneumonia; (c) no pneumonia manifestations on this chest CT image.", "latex": null, "type": "figure"}, "FIGREF1": {"text": "(a) COVID-19 image with three ground-glass focus of infections; (b) Influenza-A-viral-pneumonia image with four focus of infections; (c) the minimum distance from the mask to the center of this patch (double-headed arrow) and (d) diagonal of the minimum circumscribed rectangle of this pulmonary image.", "latex": null, "type": "figure"}, "FIGREF2": {"text": "Network structure of the location-attention oriented model.", "latex": null, "type": "figure"}, "FIGREF3": {"text": "Training curve of loss and accuracy for the two classification models.", "latex": null, "type": "figure"}, "TABREF0": {"text": "A total of 618 transverse-section CT samples were collected in this study, including 219 from 110 patients with COVID-19 from the First Affiliated Hospital of Zhejiang University, the No.6 People's Hospital of Wenzhou, and the No.1 People's Hospital of Wenling , from Jan 19 to Feb 14, 2020. All three hospitals are designated COVID-19 hospitals in Zhejiang Province. Every COVID-19 patient was confirmed with RT-PCR testing kit and we also excluded the cases that had no image manifestations on the chest CT images. In addition, there had at least two days gap between CT datasets if taken from the same patient to ensure the diversity of samples. The remaining 399 CT samples were collected from the First Affiliated Hospital of Zhejiang University as the controlled experiment group. Among them, 224 CT samples were from 224 patients with Influenza-A viral pneumonia including H1N1, H3N2, H5N1, H7N9 etc., and 175 CT samples from healthy people. There were 198 (90.4%) COVID-19 and (196) 86.6% Influenza-A cases from early or progressive stages and the rest 9.6% and 13.4% cases from severe stage respectively (P > 0.05). Moreover, Influenza-A viral pneumonia CT cases used as it was most critically to distinguish them from suspected patients with COVID-19 currently in China. The ethics committee of the First Affiliated Hospital, College of Medicine, Zhejiang University approved this study and all research was performed in accordance with relevant guidelines/regulations. All participants and/or their legal guardians signed the informed consent form before the study. A total of 528 CT samples (85.4%) were used for training and validation sets, including 189 samples of patients with COVID-19, 194 samples from patients with Influenza-A viral pneumonia, and 145 samples from healthy people. The remaining 90 CT sets (14.6% ) were used as the test set, including 30 COVID-19, 30", "latex": null, "type": "table"}, "TABREF2": {"text": "candidate cubes were generated from the 3D segmentation model. Only the territory close to the middle of this cube contained maximum information about this focus of infection. Hence, only the center image together with the two neighbors of each cube was collected to represent this region for future classification steps. Next, all image patches were manually classified by two professional radiologists into two types: irrelevant-to-infection and pneumonia. The the images in the latter category were recognized automatically as COVID-19 or Influenza-A-viral-pneumonia based on the irrelevant-to-infection images. The remaining 1,710 (14.4%) images were reserved for the test dataset. The sampling possibility of COVID-19 and Influenza-A-viral-pneumonia cases was expanded three times to balance the specimen number of irrelevant-to-infection so as to reduce the influence of the uneven distribution of different image types on the present dataset. At the same time, generic data expansion mechanisms, such as random clipping, left-right, up-down flipping, and mirroring operation, were performed on specimens to increase the number of training samples and prevent data overfitting.", "latex": null, "type": "table"}, "TABREF4": {"text": "If one of the P values was equal to 0, then the other P value was exported directly as the confidence possibility of this CT sample 3. Otherwise, the softmax function was used to generate two confidence scores. to 100% and did not alter the judgment result of infection types.", "latex": null, "type": "table"}, "TABREF5": {"text": "The accuracy of a method determines how correct the values are predicted. Precision", "latex": null, "type": "table"}, "TABREF6": {"text": "", "latex": null, "type": "table"}, "TABREF7": {"text": "", "latex": null, "type": "table"}, "TABREF8": {"text": "Influenza-A-viral-pneumonia (IAVP) and no-infection-found (NIF).Table 6. The recall, precision and f1-score from the output of the Bayesian function for COVID-19, Influenza-A-viral-pneumonia (IAVP) and no-infection-found (NIF). COVID-19, which was first detected in Wuhan China, has caused serious public health safety problems and hence become a global concern. 25-27 The severe situation puts forward new requirements for the prevention and control strategy. A large number of patients with viral pneumonia had been detected in Wuhan city. The RT-PCR test of 2019-nCoV RNA can make a definite diagnosis of COVID-19 from Influenza-A viral pneumonia patients. However, the nucleic acid testing has some defects, such as time lag, relatively low detection rate, and short of supply. In the early stage of COVID-19, some patients may already have positive pulmonary imaging findings but they have no sputum and negative test results in nasopharyngeal swabs of RT-PCR. These patients are not diagnosed as suspected or confirmed cases. Thus, they are not be isolated or treated for the first time, making them potential sources of infection.The CT imaging of COVID-19 present several distinct manifestations according to previous studies.21,22 The manifestations include focal ground glass shadows mainly distributed in bilateral lungs, multiple consolidation shadows accompanied by the \"halo sign\" of surrounding ground glass shadow in both lungs, mesh shadows and bronchiectasis and inflating signs inside the lesions, and multiple consolidation of different sizes and grid-shaped high-density shadows. However, it is not objective and accurate to distinguish COVID-19 from other diseases only with human eyes. In comparison, deep learning system-based screen models revealed more specific and reliable results by digitizing and standardizing the image information. Hence, they can assist physicians to make a quick clinical decision more accurately, which would benefit on management of suspected patients.In this study, the deep learning technology was used to design a classification network for distinguishing the COVID-19 from Influenza-A viral pneumonia. In terms of the network structure, the classical ResNet was used for feature extraction. It was compared with the network model with and without the added location-attention mechanism. The experiment showed that the aforementioned mechanism could better distinguish COVID-19 cases from others.The manifestation of COVID-19 may have some overlap with the manifestations of other pneumonias such as Influenza-A viral pneumonia, organic pneumonia and eosinophilic pneumonia. The clinical diagnosis of COVID-19 needs to combine the patients' contact history, travel history, first symptoms and laboratory examination. In this study, the number of model samples was limited. Hence, the training and test the number of samples should be expand to improve the accuracy in the future. More multi-center clinical studies should be conducted to cope with the complex clinical situation.", "latex": null, "type": "table"}}, "back_matter": [{"text": "Project Fund (20182X10101-001).", "cite_spans": [], "ref_spans": [], "section": "This study was supported by the China National Science and Technology Major"}, {"text": "The authors declare no competing interests. ", "cite_spans": [], "ref_spans": [], "section": "Competing interests"}]}