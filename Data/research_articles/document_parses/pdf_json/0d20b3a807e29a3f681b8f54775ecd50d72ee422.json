{"paper_id": "0d20b3a807e29a3f681b8f54775ecd50d72ee422", "metadata": {"title": "Optimization and Local Time Stepping of an ADER-DG Scheme for Fully Anisotropic Wave Propagation in Complex Geometries", "authors": [{"first": "Sebastian", "middle": [], "last": "Wolf", "suffix": "", "affiliation": {"laboratory": "", "institution": "Technical University of Munich", "location": {"settlement": "Munich", "country": "Germany"}}, "email": "wolf.sebastian@in.tum.de"}, {"first": "Alice-Agnes", "middle": [], "last": "Gabriel", "suffix": "", "affiliation": {"laboratory": "", "institution": "Ludwig-Maximilians-Universit\u00e4t M\u00fcnchen", "location": {"settlement": "Munich", "country": "Germany"}}, "email": ""}, {"first": "Michael", "middle": [], "last": "Bader", "suffix": "", "affiliation": {"laboratory": "", "institution": "Technical University of Munich", "location": {"settlement": "Munich", "country": "Germany"}}, "email": ""}]}, "abstract": [{"text": "We present an extension of the earthquake simulation software SeisSol to support seismic wave propagation in fully triclinic anisotropic materials. To our best knowledge, SeisSol is one of the few opensource codes that offer this feature for simulations at petascale performance and beyond. We employ a Discontinuous Galerkin (DG) method with arbitrary high-order derivative (ADER) time stepping. Here, we present a novel implementation of fully physical anisotropy with a twosided Godunov flux and local time stepping. We validate our implementation on various benchmarks and present convergence analysis with respect to analytic solutions. An application example of seismic waves scattering around the Zugspitze in the Bavarian Alps demonstrates the capabilities of our implementation to solve geophysics problems fast.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}], "body_text": [{"text": "To successfully model earthquakes and perform seismic simulations, accurate models for the source dynamics and the propagation of seismic waves are needed. For seismic wave propagation, acoustic, isotropic and anisotropic elastic, attenuating and poroelastic materials are the most important rheologies [21] . Seismic anisotropy affects speed and scattering of seismic waves depending on the direction of propagation and can be found on all scales in the solid Earth. Anisotropy can stem from finely layered or cracked materials, the internal crystal structure of minerals or the alignment of ice crystals in glaciers. Anisotropic material behavior is observed in fault zones [16, 17] and accounted for on global scale in refinements of the Preliminary Reference Earth Model [8] . Effective anisotropy on the scales of seismic wavelengths can be modeled by assuming homogeneous materials with directional dependent properties.", "cite_spans": [{"start": 303, "end": 307, "text": "[21]", "ref_id": "BIBREF20"}, {"start": 676, "end": 680, "text": "[16,", "ref_id": "BIBREF15"}, {"start": 681, "end": 684, "text": "17]", "ref_id": "BIBREF16"}, {"start": 775, "end": 778, "text": "[8]", "ref_id": "BIBREF7"}], "ref_spans": [], "section": "Introduction"}, {"text": "Anisotropy is one of the key seismic properties next to velocity and intrinsic attenuation. Locally, at the scale of earthquake fault zones, large variations in anisotropy reflect the strong material contrasts, extreme strains, and high dissipation of damaged rock. At the global scale, variations in anisotropy provide snapshots of our planet's interior that inform our understanding of plate tectonics. Imaging of anisotropy is also crucial in industry contexts such as exploration or geothermal reservoir development and maintenance. All these applications require efficient forward solvers, ideally accounting for physical anisotropy together with the geometrical complexity of the geological subsurface. Highorder accuracy is crucial to resolve small variations of anisotropy, which are often within only a few percent variation of isotropic material, depending on tectonic context.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "Anisotropic material behavior has been successfully included in Finite Difference schemes [11, 22] , pseudo-spectral methods [5] , Spectral Element codes [13] and Discontinuous Galerkin (DG) schemes for the velocity-stress formulation [20] and for the velocity-strain formulation [26] . Only few open-source codes exist which are able to simulate seismic wave propagation in anisotropic materials and which are also tailored to run efficiently on supercomputers. The DG ansatz on unstructured grids allows us to include full physical anisotropy as we do not encounter geometrical restrictions. The DG software SeisSol has undergone end-to-end performance optimization over the last years [3, 10, 25] . However, anisotropic effects have been neglected thus far.", "cite_spans": [{"start": 90, "end": 94, "text": "[11,", "ref_id": "BIBREF10"}, {"start": 95, "end": 98, "text": "22]", "ref_id": "BIBREF21"}, {"start": 125, "end": 128, "text": "[5]", "ref_id": "BIBREF4"}, {"start": 154, "end": 158, "text": "[13]", "ref_id": "BIBREF12"}, {"start": 235, "end": 239, "text": "[20]", "ref_id": "BIBREF19"}, {"start": 280, "end": 284, "text": "[26]", "ref_id": "BIBREF25"}, {"start": 688, "end": 691, "text": "[3,", "ref_id": "BIBREF2"}, {"start": 692, "end": 695, "text": "10,", "ref_id": "BIBREF9"}, {"start": 696, "end": 699, "text": "25]", "ref_id": "BIBREF24"}], "ref_spans": [], "section": "Introduction"}, {"text": "In this paper, we present a novel implementation of fully anisotropic wave propagation that exploits SeisSol's high-performance implementation of elementlocal matrix operations and supports local time stepping. We first lay out the physical model and state the governing equations (Sect. 2). In Sect. 3 these equations are discretized using the DG method combined with arbitrary high-order derivative time stepping (ADER-DG). Our main numerics contribution is to introduce a two-sided numerical flux of the Godunov type in conjunction with a free-surface boundary condition based on solving an inverse Riemann problem. We highlight details of how we implemented theses features into the existing code base, and extended it to make use of local time stepping. Here, the key novelty is a general approach to integrate a numerical eigenvalue solver in SeisSol that replaces analytically derived formulas in the respective precomputation steps. In Sect. 5 we verify our implementation against various analytical solutions and community benchmark problems. We also present an updated reference solution for the AHSP1 benchmark [18] , since our implementation revealed physical inconsistencies in the previous community reference solution. To demonstrate the capability of our code to solve real-world geophysical problems we model anisotropically scattering seismic waves radiating from a point source under the strong topography contrasts of Mount Zugspitze in the Bavarian Alps.", "cite_spans": [{"start": 1122, "end": 1126, "text": "[18]", "ref_id": "BIBREF17"}], "ref_spans": [], "section": "Introduction"}, {"text": "Linear elastic materials are characterized by a stress-strain relation in the form", "cite_spans": [], "ref_spans": [], "section": "Physical Model"}, {"text": "with stress and strain tensors denoted by \u03c3, \u2208 R 3\u00d73 . Symmetry considerations reduce the 81 parameters c ijkl to only 21 independent values [2] . Employing Voigt notation we can write the relation in a matrix-vector manner: \u239b ", "cite_spans": [{"start": 141, "end": 144, "text": "[2]", "ref_id": "BIBREF1"}], "ref_spans": [], "section": "Physical Model"}, {"text": "This constitutive relation can be combined with the equations of motion of continuum mechanics which we write in the velocity-strain formulation, where the vector Q = \u03c3 11 , \u03c3 22 , \u03c3 33 , \u03c3 13 , \u03c3 23 , \u03c3 13 , u 1 , u 2 , u 3 T defines the quantities of interest. The combined equation reads:", "cite_spans": [], "ref_spans": [], "section": "Physical Model"}, {"text": "The Jacobian matrices A d , d = 1, 2, 3, can be deduced from the stress-strain relation and have the form", "cite_spans": [], "ref_spans": [], "section": "Physical Model"}, {"text": "We observe that the second index is constant for each column. To construct the matrices C 2 and C 3 we replace these by 6, 2, 4 and 5, 4, 3 respectively. The blocks R d are the same as for the isotropic case and are detailed in [20] . The material parameters can vary in space. For better readability the space dependence has been dropped in Eq. ", "cite_spans": [{"start": 228, "end": 232, "text": "[20]", "ref_id": "BIBREF19"}], "ref_spans": [], "section": "Physical Model"}, {"text": "De la Puente et al. [20] presented the numerics of including anisotropic material effects into ADER-DG seismic wave propagation simulations. We here improve the numerical scheme by a two-sided Godunov flux and a free-surface boundary condition, as well as adaptions necessary for local time stepping with anisotropy. A two-sided flux is physically more accurate and allows for coupling between different rheologies. Local time stepping improves performance drastically.", "cite_spans": [{"start": 20, "end": 24, "text": "[20]", "ref_id": "BIBREF19"}], "ref_spans": [], "section": "Numerical Approximation"}, {"text": "To solve Eq. (3), we follow a DG ansatz [7] . The underlying geometry is approximated by a mesh of tetrahedral elements \u03c4 m . For the discretization polynomial ansatz functions \u03a6 l are defined on a reference element \u03c4 ref . On each element the numerical solution Q m p is expanded in terms of the basis functions:", "cite_spans": [{"start": 40, "end": 43, "text": "[7]", "ref_id": "BIBREF6"}], "ref_spans": [], "section": "Spatial Discretization"}, {"text": "Here the function \u039e m : \u03c4 m \u2192 \u03c4 ref is an affine linear coordinate transformation. By \u03a8 m l we denote the l th basis function transformed to the m th element. On each element Eq. (3) is multiplied by a test function and integration by parts is applied leading to a semi-discrete formulation:", "cite_spans": [], "ref_spans": [], "section": "Spatial Discretization"}, {"text": "The Jacobians A d pq are element-wise constant. AlsoQ and its time derivative are constant on each cell. This allows us to pull these quantities out of the integrals. Applying a change of variables to the reference element the integrals can be precomputed. Together with an appropriate flux formulation this leads to a quadrature-free numerical scheme.", "cite_spans": [], "ref_spans": [], "section": "Spatial Discretization"}, {"text": "In DG schemes continuity across element boundaries is only enforced in a weak sense, via the flux term (n d A d pq Q q ) * in Eq. (6) . Hence, a proper numerical flux, which also takes the underlying physics into account, is essential. De la Puente et al. [20] demonstrated anisotropy with one-sided Rusanov flux and discussed an extension to Godunov fluxes for ADER-DG. Two-sided fluxes capture the correct jump conditions of the Rankine-Hugoniot condition on both sides of the interelement boundaries. They have been introduced to SeisSol in [23] for acoustic and (visco)elastic materials. In the following we give an overview over the most important aspects of using two-sided flux formulations and on generalizing the isotropic flux to a two-sided formulation for the anisotropic case.", "cite_spans": [{"start": 130, "end": 133, "text": "(6)", "ref_id": "BIBREF5"}, {"start": 256, "end": 260, "text": "[20]", "ref_id": "BIBREF19"}, {"start": 544, "end": 548, "text": "[23]", "ref_id": "BIBREF22"}], "ref_spans": [], "section": "Flux and Boundary Conditions"}, {"text": "In Eq. (6), the surface integral over \u2202\u03c4 m can be dispatched into four integrals over the four triangular faces of each element. We evaluate the flux for each face individually, so we need to transform the quantities Q as well as the stressstrain relation into face-aligned coordinate systems. For anisotropic materials the stress-strain relation is represented by the matrix H, see Eq. (2). We can express the constitutive behavior in the face-aligned coordinate system via the matrixH = N \u00b7H\u00b7N T (cf. [4] ), where N is the so-called Bond matrix (cf. [20] ). We define the matrix\u00c3 to have the same structure as the matrix A 1 but with entries c ij from the matrixH. At each face we have the Jacobians and approximations on the inside\u00c3 \u2212 , Q \u2212 and on the outside\u00c3 + , Q + .", "cite_spans": [{"start": 503, "end": 506, "text": "[4]", "ref_id": "BIBREF3"}, {"start": 552, "end": 556, "text": "[20]", "ref_id": "BIBREF19"}], "ref_spans": [], "section": "Flux and Boundary Conditions"}, {"text": "The Godunov flux approximates the solution at the element boundary by solving a Riemann problem across the element interfaces. First the equations are transformed to a face-aligned coordinate system. The Rankine-Hugoniot condition states that discontinuities travel with wave speeds given via the eigenvalues of the Jacobian. The differences between the quantities are the corresponding eigenvectors. A detailed derivation can be found in [23, 26] .", "cite_spans": [{"start": 439, "end": 443, "text": "[23,", "ref_id": "BIBREF22"}, {"start": 444, "end": 447, "text": "26]", "ref_id": "BIBREF25"}], "ref_spans": [], "section": "Flux and Boundary Conditions"}, {"text": "We observe that the eigenvectors of the Jacobian\u00c3 have the form ", "cite_spans": [], "ref_spans": [], "section": "Flux and Boundary Conditions"}, {"text": "The eigenvectors and corresponding eigenvalues resemble three incoming and outgoing waves. To take different material values on the inside and outside into account an eigendecomposition of both Jacobians\u00c3 \u2212 and\u00c3 + is performed and the matrix R is constructed taking the first three columns from R \u2212 and the last three columns from R + . With indicator matrices I \u2212 = diag(1, 1, 1, 0, 0, 0, 0, 0, 0) and I + = diag(0, 0, 0, 0, 0, 0, 1, 1, 1), we can then compute the flux as:", "cite_spans": [], "ref_spans": [], "section": "Flux and Boundary Conditions"}, {"text": "Here T is a matrix that rotates Q from the global coordinate system to the facealigned coordinate system. We take into account that the first six components of Q \u2208 R 9 represent a symmetric tensor and the last three components represent a vector. Both parts can be rotated independently, so T combines the rotation of tensorial and vectorial quantities. Analogous to inter-element boundaries, we also impose boundary conditions via a specialized flux. For a free surface boundary we want to impose s = \u03c3n = 0. In Eq. (8) the term RI + R \u22121 T \u22121 Q \u2212 is identified with the state at the inside of the inter-element boundary. We can use this fact to construct a flux which will yield the free surface boundary. To do so we set the traction s to zero and compute the velocity u consistently:", "cite_spans": [], "ref_spans": [], "section": "Flux and Boundary Conditions"}, {"text": "Superscripts b denote values at the boundary. The values s \u2212 and u \u2212 are the traction and velocity in the face-aligned coordinate system. The matrices R 11 and R 21 slice out the first three columns of R and the rows corresponding to the traction respectively the velocity components. The flux is obtained as F = T\u00c3 \u2212 Q b . Note that we did not specify the non-traction components of \u03c3. As these lie in the null space of the Jacobian\u00c3 the flux is not altered by their value.", "cite_spans": [{"start": 153, "end": 155, "text": "11", "ref_id": "BIBREF10"}], "ref_spans": [], "section": "Flux and Boundary Conditions"}, {"text": "To integrate Eq. (6) in time SeisSol employs the ADER method [6] . ADER time stepping expands each element solution locally in time as a Taylor series up to a certain order. The time derivatives are replaced by the discretized spatial derivatives following the Cauchy-Kowalewski theorem. To update one element we therefore only need the values of the element itself and its four neighbors, which fosters efficient parallelization. ADER time stepping inherently supports local time stepping [7] : Smaller elements or elements with high wave speeds will be updated more often than large elements or elements with low wave speeds. Local time stepping is thus crucial for performant applications that use strong adaptive mesh refinement or where meshes suffer from badly shaped elements. Setups with a heterogeneous material can also benefit substantially from local time stepping.", "cite_spans": [{"start": 61, "end": 64, "text": "[6]", "ref_id": "BIBREF5"}, {"start": 490, "end": 493, "text": "[7]", "ref_id": "BIBREF6"}], "ref_spans": [], "section": "Time Discretization"}, {"text": "Each element has to satisfy the stability criterion \u0394t m < 1", "cite_spans": [], "ref_spans": [], "section": "Time Discretization"}, {"text": "l m v m for the time step size \u0394t m , where l m and v m denote the in-sphere diameter and maximum wave speed of element \u03c4 m , N is the order of the method.", "cite_spans": [], "ref_spans": [], "section": "2N +1"}, {"text": "In anisotropic materials the wave speeds depend on the direction of propagation. This has not been considered in previous work (e.g. [7] ). For a fixed direction d we define the matrix M (d) ij = d k c iklj d l . We calculate the wave speeds in direction d from the eigenvalues \u03bb i of the matrix M (d) via v i = \u03bb i /\u03c1 resulting in a primary and two secondary waves (cf. [4] ). The element-wise maximum wave speed is the maximum of these speeds over all directions d.", "cite_spans": [{"start": 133, "end": 136, "text": "[7]", "ref_id": "BIBREF6"}, {"start": 371, "end": 374, "text": "[4]", "ref_id": "BIBREF3"}], "ref_spans": [], "section": "2N +1"}, {"text": "SeisSol's ADER-DG discretization is implemented via element-local matrix chain multiplications, which allows for high performance on modern CPUs [10, 25] . All required matrices are precomputed in the initialization phase and optimized kernels are generated for the matrix chain operations [24] . In the following we present the most important choices we made for our implementation of anisotropy. Concerning the matrices, the compute kernels of the isotropic case can be reused, just the assembly of the Jacobians and flux matrices differs.", "cite_spans": [{"start": 145, "end": 149, "text": "[10,", "ref_id": "BIBREF9"}, {"start": 150, "end": 153, "text": "25]", "ref_id": "BIBREF24"}, {"start": 290, "end": 294, "text": "[24]", "ref_id": "BIBREF23"}], "ref_spans": [], "section": "Implementation"}, {"text": "For each element we store the material values. In comparison to isotropic materials 22 instead of 3 values have to be stored. This overhead is negligible compared to the storage required for the degrees of freedoms. For example, a discretization of order 6 requires 504 degrees of freedom per element.", "cite_spans": [], "ref_spans": [], "section": "Storage Requirements"}, {"text": "Concerning the storage of the precomputed matrices, only the Jacobians A and the flux matrices G + and G \u2212 change between the isotropic and the anisotropic case. Based on the sparsity pattern of a matrix, the biggest rectangular non-zero block of the matrix is stored. We store the matrices A, G + and G \u2212 as full 9 \u00d7 9 matrices for the isotropic as well as for the anisotropic case, thus no overhead is produced. The underlying data structures are not changed.", "cite_spans": [], "ref_spans": [], "section": "Storage Requirements"}, {"text": "Unlike as with isotropic materials the eigenstructure of the Jacobians given in Eq. (7) is hard to express analytically. In the applied scheme the eigendecomposition has to be calculated once for every element. We use the open source software package Eigen3 [9] to obtain the eigenvectors numerically. We chose this approach for three reasons:", "cite_spans": [{"start": 258, "end": 261, "text": "[9]", "ref_id": "BIBREF8"}], "ref_spans": [], "section": "Calculation of the Flux Term"}, {"text": "(i) Even if an analytic expression for the eigenvalues is available it is lengthy and hence the implementation is error-prone. (ii) From a software engineering point of view the use of the numerical eigenvalue solver replaces a lot of code that was previously needed for each material model individually. We unified the formulation of the Riemann solver for all material models (isotropic, anisotropic and viscoelastic). We use templating to distinguish the assembly of the Jacobians for each model. From then on we can use the same code to precalculate G + and G \u2212 . We expect that these software engineering choices make it easy to include additional material models into SeisSol in the future. Also coupling between different material models within the same simulation can be obtained with little overhead. (iii) The question of accuracy and stability of the numerical solver may arise.", "cite_spans": [], "ref_spans": [], "section": "Calculation of the Flux Term"}, {"text": "But stability of an analytically derived formula is also not guaranteed. Round-off errors and cancellation could drastically influence the accuracy of the derived eigenvectors. With our choice for using a stable numerical solver instead, we circumvent this problem.", "cite_spans": [], "ref_spans": [], "section": "Calculation of the Flux Term"}, {"text": "Local time stepping is implemented with a clustered scheme to meet the requirements of modern supercomputers [3] . To cluster the elements the required time step for each element has to be known in advance. To obtain the maximum wave speed for one element, we would have to find the maximum wave speed over all directions. This boils down to solving an optimization problem which involves the calculation of eigenvalues of arbitrary matrices. Solving this optimization problem analytically results in lengthy calculations. In practice, the time step is relaxed by a security factor to meet the CFL condition, so the maximum wave speed does not have to be computed exactly. We sample the wave speeds for several directions d and take their maximum as the maximum wave speed v m .", "cite_spans": [{"start": 109, "end": 112, "text": "[3]", "ref_id": "BIBREF2"}], "ref_spans": [], "section": "Maximal Wave Speeds for Local Time Stepping"}, {"text": "Planar wave analytic descriptions are widely used in wave propagation problems.", "cite_spans": [], "ref_spans": [], "section": "Convergence Analysis"}, {"text": "Here we present a numerical convergence study to analyze the correct implementation to confirm its expected convergence properties. To this end, we verify our implementation solving the 3-D, anisotropic, seismic wave equations in the form of periodic, sinusoidal waves in a unit-cube as explained in [19] . The computational domain is the unit cube [\u22121, 1] 3 with periodic boundary conditions. The ansatz for our plane-wave solution is", "cite_spans": [{"start": 300, "end": 304, "text": "[19]", "ref_id": "BIBREF18"}], "ref_spans": [], "section": "Convergence Analysis"}, {"text": "where \u03c9 denotes the frequency and k is the vector of wave numbers. When we combine this with Eq. (3) we see that the initial condition Q 0 has to be a solution of the eigenvalue problem", "cite_spans": [], "ref_spans": [], "section": "Convergence Analysis"}, {"text": "In the case of linear elasticity there is a zero eigenvalue with multiplicity 3. The other eigenvalues appear pairwise with different signs and correspond to the P wave and two S waves. For isotropic materials the two S waves coincide, whereas for anisotropic media a slow and a fast S wave can be distinguished. For linear PDEs a linear combination of several solutions is a solution again. To take the directional dependence of anisotropic materials into account we superimpose three planar waves with wave number vectors k 1 = \u03c0, 0, 0 , k 2 = 0, \u03c0, 0 and k 3 = 0, 0, \u03c0 . For each direction a P wave traveling in the direction of k l and an S wave traveling in the opposite direction has been chosen. When we denote the eigenvectors of the matrix A d k l d with R l and the corresponding eigenvalues with \u03c9 l , the analytic solution can be written as", "cite_spans": [], "ref_spans": [], "section": "Convergence Analysis"}, {"text": "The computational domain is discretized into cubes of edge length h = ", "cite_spans": [], "ref_spans": [], "section": "Convergence Analysis"}, {"text": "We compare the numerical solution to the analytic solution at time t = 0.02. Figure 1 shows the convergence behavior for the stress component \u03c3 11 in the L 2 -norm. We clearly observe the expected convergence orders. The plots for the L 1 -and L \u221e -norm are comparable. All other quantities also show the expected convergence rates.", "cite_spans": [], "ref_spans": [{"start": 77, "end": 85, "text": "Figure 1", "ref_id": "FIGREF3"}], "section": "Convergence Analysis"}, {"text": "The community benchmark LOH1 [18] is designed for isotropic elastic materials. We here use it to validate backwards compatibility, as isotropic elasticity is a special case of anisotropic elasticity. The setup consists of a layered half space On all other surfaces than the free surface (x 3 = 0) we impose absorbing boundary conditions. The mesh is refined around the source and coarsened away from it. The characteristic length is approximately 300 m in the vicinity of the source and grows up to 2000 m towards the boundary. In total the mesh consists of 2.57 million cells. The mesh is large enough that waves do not leave the domain during the computational time and we do not observe problems with artificial reflections. At the same time we keep the computational effort reasonable due to the coarsening towards the absorbing boundaries.", "cite_spans": [{"start": 29, "end": 33, "text": "[18]", "ref_id": "BIBREF17"}], "ref_spans": [], "section": "Isotropy via Anisotropy: Layer over Halfspace (LOH1)"}, {"text": "We ran the simulation with convergence order 6 up to a final time of 5 s and compared our solutions to the reference solution using envelope and pulse misfit [14] . We recorded the velocities at all nine receivers. In Table 1 we present the results for the third, sixth and ninth receiver, which are farthest away from the source (the longer the wave is propagated, the less accurately it is typically resolved due to numerical dissipation and dispersion). With a maximal envelope misfit of 1.32% and a maximal phase misfit of 0.20% we are well within the highest level of accuracy defined in the LOH1 benchmark description. To investigate the computational overhead of incorporating anisotropic effects, we compare the execution times for the setup executed with the isotropic and the anisotropic implementation. We ran each simulation 5 times on 100 nodes of SuperMUC-NG (Intel Skylake Xeon Platinum 8174, 48 cores per node) and averaged the total wall time. The average runtime of the anisotropic implementation was 185.0 s, which is only a little slower than the isotropic implementation, which averaged at 184.6 s. The difference between the runtimes may be explained by the more complicated initialization phase for the anisotropic case. We also point out that the deviation in run times in between different runs was larger than the difference between the averages. The computations achieved an average of 990.3 GFlop/s in the isotropic case and 994.7 GFlop/s in the anisotropic case.", "cite_spans": [{"start": 158, "end": 162, "text": "[14]", "ref_id": "BIBREF13"}], "ref_spans": [{"start": 218, "end": 225, "text": "Table 1", "ref_id": "TABREF1"}], "section": "Isotropy via Anisotropy: Layer over Halfspace (LOH1)"}, {"text": "The SISMOWINE test suite [18] proposes the following test case for seismic wave propagation in anisotropic materials: The geometry is a homogeneous full space.", "cite_spans": [{"start": 25, "end": 29, "text": "[18]", "ref_id": "BIBREF17"}], "ref_spans": [], "section": "Anisotropic Homogeneous Space (AHSP, SISMOWINE)"}, {"text": "The homogeneous material has a density of \u03c1 = 2700 kg m 3 . The elastic response is characterized by the elastic tensor c ij = 0 expect for ", "cite_spans": [], "ref_spans": [], "section": "Anisotropic Homogeneous Space (AHSP, SISMOWINE)"}, {"text": "The source is identical to the LOH1 benchmark. We again refine the mesh around the source with a characteristic edge length of about 300 m and coarsen away from the source. This results in a total of 3.98 million cells. To simulate a full space, absorbing boundary conditions are imposed on all six surfaces. Just as for the LOH1 test case we do not encounter artificial reflections from the boundaries. Figure 2 shows an exemplary comparison between our new implementation and the reference solution of SISMOWINE. One can clearly see that the reference solution does not feature a second shear wave whereas our implementation does. Since shear wave splitting is a well-known physical feature of wave propagation in anisotropic media [2] we assume an error in the proposed reference solution. The correctness of our calculation is confirmed in comparison to an analytical reference: We used the open source tool christoffel [12] to compute the wave speeds for the given material depending on the direction of wave propagation. The shown receiver 6 is located at (7348, 7348, 0), 10392 m away from the source. The calculated arrival time for the P wave is 1.73 s, the slow and the fast S wave arrive after 2.59 s and 3.00 s respectively. We observe that the arrival times align very well with the results calculated by the new SeisSol implementation. In agreement with the original authors and the maintainers of the SISMOWINE project, our here presented solution has been accepted as the new reference solution due to its physical plausibility.", "cite_spans": [{"start": 734, "end": 737, "text": "[2]", "ref_id": "BIBREF1"}, {"start": 924, "end": 928, "text": "[12]", "ref_id": "BIBREF11"}], "ref_spans": [{"start": 404, "end": 412, "text": "Figure 2", "ref_id": "FIGREF5"}], "section": "Anisotropic Homogeneous Space (AHSP, SISMOWINE)"}, {"text": "For transversally isotropic materials analytical solutions can be found along the axis of symmetry [5] . As mentioned earlier the representation of the elastic tensor depends on the chosen coordinate system. By tilting the symmetry axis of the transversally isotropic material we can generate an almost densely filled elastic tensor. We take the material characterized by the tensor c ij = 0 except for ", "cite_spans": [{"start": 99, "end": 102, "text": "[5]", "ref_id": "BIBREF4"}], "ref_spans": [], "section": "Tilted Transversally Isotropic Medium"}, {"text": "and density \u03c1 = 2590 kg m 3 and tilt it around the x axis about 30 \u2022 . We consider the computational domain \u03a9 = [0, 2500] 3 . The source is placed at (1250, 1562.5, 937.5) and a receiver is placed at (1250, 1198.05, 1568.75), which is along the symmetry axis of the tilted material 728.9 m away from the source. The source either acts along the axis of symmetry or orthogonal to the axis. The time history is a Ricker wavelet with dominant frequency f 0 = 16.0 Hz and onset time t 0 = 0.07 s. The whole simulation was run for 0.6 s on a mesh which is refined in a sphere around the source and in a cylinder along the axis of symmetry. In the most refined region the characteristic length is 5 m and grows towards the boundary. In total the mesh consisted of 6.10 million elements.", "cite_spans": [], "ref_spans": [], "section": "Tilted Transversally Isotropic Medium"}, {"text": "We compare our solution obtained at the receiver with the analytic solution using envelope and pulse misfit. For the horizontal source we obtained a maximal envelope misfit of 2.09% and a pulse misfit of 0.49%. For the vertical source the misfits were 2.16% and 0.28% respectively. For both source types the numerical solution fits the analytic solution very well. ", "cite_spans": [], "ref_spans": [], "section": "Tilted Transversally Isotropic Medium"}, {"text": "Accurate numerical simulation of scattering seismic waves by complex geometries are critical for assessing and quantifying seismic hazards. In the context of regional scale seismology wave propagation simulations, many numerical methods are challenged by geometric restrictions or low-order accuracy. We here spatially discretize the surface topography around Mount Zugspitze [1] in an unstructured tetrahedral computational mesh of size 90 km \u00d7 90 km up to 70 km depth with a resolution of 600 m at the surface. The mesh contains 1.47 million cells. We chose a discretization of order 6 which results in 740 million degrees of freedom. This means we can resolve frequencies up to 4.2 Hz with an estimated envelope misfit smaller than 1% [15] . A kinematic point source with the same parameters as for the LOH1 test case is placed in the center of the domain at 10 km depth. We visually compare the wave field scattered by topography in an isotropic material with parameters \u03c1 = 2670 kg m 3 , \u03bb = 36.4 GPa, \u03bc = 29.8 GPa with an anisotropic material. The elastic tensor is chosen such that in EWdirection the P wave speed is 6000 m s for both materials. To illustrate the effects of anisotropy the P wave speed in NS-direction of the anisotropic material is 5% lower.", "cite_spans": [{"start": 376, "end": 379, "text": "[1]", "ref_id": null}, {"start": 738, "end": 742, "text": "[15]", "ref_id": "BIBREF14"}], "ref_spans": [], "section": "Application Example: Mount Zugspitze"}, {"text": "In Fig. 3 snapshots of the vertical velocity field on the free surface are plotted. A circular shape for the isotropic example and an elliptic shape for the anisotropic part illustrate the effects of anisotropic materials on wave propagation under strong velocity contrast. We compare this simulation with and without local time stepping: moving from global to local time stepping drastically reduced the execution time from 5990 s to 210 s. The simulation was run on 50 nodes of SuperMUC-NG. The computational more intense version with global time stepping achieved 1.414 TFlop/s, the version with local time stepping achieved 1.015 TFlop/s. This shows that local time stepping is crucial to obtain fast simulations when the element sizes vary a lot, such as in the case of surface topography.", "cite_spans": [], "ref_spans": [{"start": 3, "end": 9, "text": "Fig. 3", "ref_id": "FIGREF0"}], "section": "Application Example: Mount Zugspitze"}, {"text": "The earthquake simulation code SeisSol has been successfully extended to take general anisotropic materials into account. A two-sided Godunov flux for anisotropic media has been derived and implemented. Together with the formulation of the free-surface boundary condition as the solution of an inverse Riemann problem it fits well with the other rheological models. Necessary changes to include local time stepping have been described and implemented.", "cite_spans": [], "ref_spans": [], "section": "Conclusion"}, {"text": "The scheme has been validated against various benchmarks. The expected convergence rates are demonstrated in comparison to analytic solutions. The mismatch between our results on a community benchmark have been discussed with the maintainers and led to an update of the reference solution.", "cite_spans": [], "ref_spans": [], "section": "Conclusion"}, {"text": "As anisotropy is non-neglectable to describe the Earth's subsurface structure we expect a wide range of applications. Besides the importance of seismic anisotropy for exploration purposes, earthquake fault zones may be characterised by pervasive anisotropy. Earthquake monitoring and forecasting can be built upon this observation.", "cite_spans": [], "ref_spans": [], "section": "Conclusion"}], "bib_entries": {"BIBREF1": {"ref_id": "b1", "title": "Quantitative Seismology, 2nd edn", "authors": [{"first": "K", "middle": [], "last": "Aki", "suffix": ""}, {"first": "P", "middle": [], "last": "Richards", "suffix": ""}], "year": 2002, "venue": "University Science Books", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF2": {"ref_id": "b2", "title": "Petascale local time stepping for the ADER-DG finite element method", "authors": [{"first": "A", "middle": [], "last": "Breuer", "suffix": ""}, {"first": "A", "middle": [], "last": "Heinecke", "suffix": ""}, {"first": "M", "middle": [], "last": "Bader", "suffix": ""}], "year": 2016, "venue": "IPDPS", "volume": "", "issn": "", "pages": "854--863", "other_ids": {}}, "BIBREF3": {"ref_id": "b3", "title": "Wave Fields in Real Media", "authors": [{"first": "J", "middle": ["M"], "last": "Carcione", "suffix": ""}], "year": 2015, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF4": {"ref_id": "b4", "title": "A spectral scheme for wave propagation simulation in 3-D elastic-anisotropic media", "authors": [{"first": "J", "middle": ["M"], "last": "Carcione", "suffix": ""}, {"first": "D", "middle": [], "last": "Kosloff", "suffix": ""}, {"first": "A", "middle": [], "last": "Behle", "suffix": ""}, {"first": "G", "middle": [], "last": "Seriani", "suffix": ""}], "year": 1992, "venue": "Geophysics", "volume": "57", "issn": "12", "pages": "1593--1607", "other_ids": {}}, "BIBREF5": {"ref_id": "b5", "title": "An arbitrary high-order discontinuous Galerkin method for elastic waves on unstructured meshes -II. The three-dimensional isotropic case", "authors": [{"first": "M", "middle": [], "last": "Dumbser", "suffix": ""}, {"first": "M", "middle": [], "last": "K\u00e4ser", "suffix": ""}], "year": 2006, "venue": "Geophys. J. Int", "volume": "167", "issn": "1", "pages": "319--336", "other_ids": {}}, "BIBREF6": {"ref_id": "b6", "title": "An arbitrary high-order discontinuous Galerkin method for elastic waves on unstructured meshes -V. Local time stepping and p-adaptivity", "authors": [{"first": "M", "middle": [], "last": "Dumbser", "suffix": ""}, {"first": "M", "middle": [], "last": "K\u00e4ser", "suffix": ""}, {"first": "E", "middle": ["F"], "last": "Toro", "suffix": ""}], "year": 2007, "venue": "Geophys. J. Int", "volume": "171", "issn": "2", "pages": "695--717", "other_ids": {}}, "BIBREF7": {"ref_id": "b7", "title": "Preliminary reference earth model", "authors": [{"first": "A", "middle": ["M"], "last": "Dziewonski", "suffix": ""}, {"first": "D", "middle": ["L"], "last": "Anderson", "suffix": ""}], "year": 1981, "venue": "Phys. Earth Planet. Inter", "volume": "25", "issn": "", "pages": "297--356", "other_ids": {}}, "BIBREF8": {"ref_id": "b8", "title": "Eigen v3", "authors": [{"first": "G", "middle": [], "last": "Guennebaud", "suffix": ""}, {"first": "B", "middle": [], "last": "Jacob", "suffix": ""}], "year": 2010, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF9": {"ref_id": "b9", "title": "Petascale high order dynamic rupture earthquake simulations on heterogeneous supercomputers", "authors": [{"first": "A", "middle": [], "last": "Heinecke", "suffix": ""}], "year": 2014, "venue": "Proceedings of SC 2014", "volume": "", "issn": "", "pages": "3--14", "other_ids": {}}, "BIBREF10": {"ref_id": "b10", "title": "Anisotropic wave propagation through finitedifference grids", "authors": [{"first": "H", "middle": [], "last": "Igel", "suffix": ""}, {"first": "P", "middle": [], "last": "Mora", "suffix": ""}, {"first": "B", "middle": [], "last": "Riollet", "suffix": ""}], "year": 1995, "venue": "Geophysics", "volume": "60", "issn": "4", "pages": "1203--1216", "other_ids": {}}, "BIBREF11": {"ref_id": "b11", "title": "Solving the christoffel equation: phase and group velocities", "authors": [{"first": "J", "middle": ["W"], "last": "Jaeken", "suffix": ""}, {"first": "S", "middle": [], "last": "Cottenier", "suffix": ""}], "year": 2016, "venue": "Comput. Phys. Commun", "volume": "207", "issn": "", "pages": "445--451", "other_ids": {}}, "BIBREF12": {"ref_id": "b12", "title": "Simulation of anisotropic wave propagation based upon a spectral element method", "authors": [{"first": "D", "middle": [], "last": "Komatitsch", "suffix": ""}, {"first": "C", "middle": [], "last": "Barnes", "suffix": ""}, {"first": "J", "middle": [], "last": "Tromp", "suffix": ""}], "year": 2000, "venue": "Geophysics", "volume": "65", "issn": "4", "pages": "1251--1260", "other_ids": {}}, "BIBREF13": {"ref_id": "b13", "title": "Time-frequency misfit and goodness-offit criteria for quantitative comparison of time signals", "authors": [{"first": "M", "middle": [], "last": "Kristekov\u00e1", "suffix": ""}, {"first": "J", "middle": [], "last": "Kristek", "suffix": ""}, {"first": "P", "middle": [], "last": "Moczo", "suffix": ""}], "year": 2009, "venue": "Geophys. J. Int", "volume": "178", "issn": "2", "pages": "813--825", "other_ids": {}}, "BIBREF14": {"ref_id": "b14", "title": "Quantitative accuracy analysis of the discontinuous Galerkin method for seismic wave propagation", "authors": [{"first": "M", "middle": [], "last": "K\u00e4ser", "suffix": ""}, {"first": "V", "middle": [], "last": "Hermann", "suffix": ""}, {"first": "J", "middle": [], "last": "De La Puente", "suffix": ""}], "year": 2008, "venue": "Geophys. J. Int", "volume": "173", "issn": "3", "pages": "990--999", "other_ids": {}}, "BIBREF15": {"ref_id": "b15", "title": "Observation and modelling of fault-zone fracture seismic anisotropy -I. P, SV and SH travel times", "authors": [{"first": "P", "middle": ["C"], "last": "Leary", "suffix": ""}, {"first": "Y", "middle": ["G"], "last": "Li", "suffix": ""}, {"first": "K", "middle": [], "last": "Aki", "suffix": ""}], "year": 1987, "venue": "Geophys. J. Int", "volume": "91", "issn": "2", "pages": "461--484", "other_ids": {}}, "BIBREF16": {"ref_id": "b16", "title": "Seismic anisotropy in central north Anatolian fault zone and its implications on crustal deformation", "authors": [{"first": "A", "middle": [], "last": "Licciardi", "suffix": ""}, {"first": "T", "middle": [], "last": "Eken", "suffix": ""}, {"first": "T", "middle": [], "last": "Taymaz", "suffix": ""}, {"first": "N", "middle": [], "last": "Piana Agostinetti", "suffix": ""}, {"first": "S", "middle": [], "last": "Yolsal-\u00c7 Evikbilen", "suffix": ""}], "year": 2018, "venue": "Phys. Earth Planet. Inter", "volume": "277", "issn": "", "pages": "99--112", "other_ids": {}}, "BIBREF17": {"ref_id": "b17", "title": "Comparison of numerical methods for seismic wave propagation and source dynamics -the SPICE code validation", "authors": [{"first": "P", "middle": [], "last": "Moczo", "suffix": ""}], "year": 2006, "venue": "3rd International Symposium on the Effects of Surface Geology on Seismic Motion", "volume": "", "issn": "", "pages": "1--10", "other_ids": {}}, "BIBREF18": {"ref_id": "b18", "title": "Discontinuous Galerkin methods for wave propagation in poroelastic media", "authors": [{"first": "J", "middle": [], "last": "De La Puente", "suffix": ""}, {"first": "M", "middle": [], "last": "Dumbser", "suffix": ""}, {"first": "M", "middle": [], "last": "K\u00e4ser", "suffix": ""}, {"first": "H", "middle": [], "last": "Igel", "suffix": ""}], "year": 2008, "venue": "Geophysics", "volume": "73", "issn": "5", "pages": "77--97", "other_ids": {}}, "BIBREF19": {"ref_id": "b19", "title": "An arbitrary high-order discontinuous Galerkin method for elastic waves on unstructured meshes -IV", "authors": [{"first": "J", "middle": [], "last": "De La Puente", "suffix": ""}, {"first": "M", "middle": [], "last": "K\u00e4ser", "suffix": ""}, {"first": "M", "middle": [], "last": "Dumbser", "suffix": ""}, {"first": "H", "middle": [], "last": "Igel", "suffix": ""}], "year": 2007, "venue": "Anisotropy. Geophys. J. Int", "volume": "169", "issn": "3", "pages": "1210--1228", "other_ids": {}}, "BIBREF20": {"ref_id": "b20", "title": "An Introduction to Seismology, Earthquakes, and Earth Structure", "authors": [{"first": "S", "middle": [], "last": "Stein", "suffix": ""}, {"first": "M", "middle": [], "last": "Wysession", "suffix": ""}], "year": 2002, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF21": {"ref_id": "b21", "title": "3D seismic wavefield modeling in generally anisotropic media with a topographic free surface by the curvilinear grid finite-difference method 3D seismic wavefield modeling in generally anisotropic media", "authors": [{"first": "Y", "middle": ["C"], "last": "Sun", "suffix": ""}, {"first": "W", "middle": [], "last": "Zhang", "suffix": ""}, {"first": "X", "middle": [], "last": "Chen", "suffix": ""}], "year": 2018, "venue": "Bull. Seismol. Soc. Am", "volume": "108", "issn": "3A", "pages": "1287--1301", "other_ids": {}}, "BIBREF22": {"ref_id": "b22", "title": "Flexible model extension and optimisation for earthquake simulations at extreme scale", "authors": [{"first": "C", "middle": [], "last": "Uphoff", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF23": {"ref_id": "b23", "title": "Yet another tensor toolbox for discontinuous Galerkin methods and other applications", "authors": [{"first": "C", "middle": [], "last": "Uphoff", "suffix": ""}, {"first": "M", "middle": [], "last": "Bader", "suffix": ""}], "year": 2019, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF24": {"ref_id": "b24", "title": "Extreme scale multi-physics simulations of the tsunamigenic 2004 Sumatra megathrust earthquake", "authors": [{"first": "C", "middle": [], "last": "Uphoff", "suffix": ""}], "year": 2017, "venue": "Proceedings of SC 2017", "volume": "21", "issn": "", "pages": "", "other_ids": {}}, "BIBREF25": {"ref_id": "b25", "title": "Full-anisotropic poroelastic wave modeling: a discontinuous Galerkin algorithm with a generalized wave impedance", "authors": [{"first": "Q", "middle": [], "last": "Zhan", "suffix": ""}], "year": 2019, "venue": "Comput. Methods Appl. Mech. Eng", "volume": "346", "issn": "", "pages": "288--311", "other_ids": {}}}, "ref_entries": {"FIGREF0": {"text": ". Isotropic material behavior can be seen as a specialization of anisotropy, where c 11 = c 22 = c 33 = \u03bb + 2\u03bc, c 12 = c 13 = c 23 = \u03bb, c 44 = c 55 = c 66 = \u03bc and all other parameters are zero.", "latex": null, "type": "figure"}, "FIGREF2": {"text": "Each cube is split up into five tetrahedrons. The material is given by density \u03c1 = 1.00 kg m 3 and the elastic tensor c ij = 0 except for c 11 = 192 Pa c 12 = 66.0 Pa c 13 = 60.0 Pa c 22 = 160 Pa c 23 = 56.0 Pa c 33 = 272 Pa c 44 = 60.0Pa c 55 = 62.0 Pa c 66 = 49.6 Pa.", "latex": null, "type": "figure"}, "FIGREF3": {"text": "3D unit cube plane wave test case. Visualization of convergence behavior of the stress component \u03c311. The L 2 error is shown versus the mesh spacing h. with a free surface boundary on top. The top layer is 1 km thick with material parameters \u03c1 = 2600 kg m 3 , \u03bc = 10.4 GPa and \u03bb = 20.8 GPa. The half space below has material parameters \u03c1 = 2700 kg m 3 , \u03bc = \u03bb = 32.4 GPa. The source is a double couple point source with the only non-zero moment M xy located in 2 km depth. The moment rate time history is given by the function M xy (t) = M 0 t T 2 exp \u2212 t T 2 with maximal moment M 0 = 10 18 Nm and onset time t = 0.1 s. We compare the velocities at the free surface to the given reference solutions. There are nine receivers located along three different lines through the origin. The domain is the cuboid [\u221240000, 40000] \u00d7 [\u221240000, 40000] \u00d7 [0, 32500] m 3 .", "latex": null, "type": "figure"}, "FIGREF4": {"text": "c 11 = 97.2 GPa c 12 = 10.0 GPa c 13 = 30.0 GPa c 22 = 97.2 GPa c 23 = 30.0 GPa c 33 = 70.0 GPa c 44 = 32.4 GPa c 55 = 32.4 GPa c 66 = 43.6 GPa.", "latex": null, "type": "figure"}, "FIGREF5": {"text": "Comparison of velocity component in x direction for receiver 6", "latex": null, "type": "figure"}, "FIGREF6": {"text": "c 11 = 66.6 GPa c 12 = 19.7 GPa c 13 = 39.4 GPa c 22 = 66.6 GPa c 23 = 39.4 GPa c 33 = 39.9 GPa c 44 = 10.9 GPa c 55 = 10.9 GPa c 66 = 23.6 GPa.", "latex": null, "type": "figure"}, "FIGREF7": {"text": "Isotropic (left) vs. anisotropic (right) seismic wave field scattered at the strong topography free surface of Mount Zugspitze at t = 3 s simulation time.", "latex": null, "type": "figure"}, "TABREF1": {"text": "Envelope and pulse misfits for the different velocity components", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Receiver </td><td>EM </td><td>\u00a0</td><td>\u00a0</td><td>PM\n</td><td>\u00a0</td><td>\u00a0</td></tr><tr><td>x </td><td>y </td><td>z </td><td>x </td><td>y </td><td>z\n</td></tr><tr><td>3 </td><td>1.32% </td><td>0.06% </td><td>0.06% </td><td>0.15% </td><td>0.00% </td><td>0.00%\n</td></tr><tr><td>6 </td><td>0.79% </td><td>0.79% </td><td>1.04% </td><td>0.12% </td><td>0.10% </td><td>0.12%\n</td></tr><tr><td>9 </td><td>0.99% </td><td>1.04% </td><td>0.83% </td><td>0.14% </td><td>0.10% </td><td>0.10%\n</td></tr></table></body></html>"}}, "back_matter": []}